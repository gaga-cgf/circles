<h1>用户登录</h1>

<div class="row">
  <div class="col-sm-4">
    <%= form_tag sessions_path, method: 'post', remote: true, class: 'signin_form' do %>
      <div class="form-group">
        <input type="text" name="username" placehoder="用户名..." class="form-control" id="form_username" title="用户名6-12字符">
      </div>

      <div class="form-group">
        <input type="password" name="password" placehoder="密码..." class="form-control" id="form_password" title="用户名6-12字符">
      </div>
      <input type="submit" class="btn btn-primary sign_btn" value="登录">
      <%= link_to "注册", new_user_path%>
    <% end %>
  </div>
  <div class="col-sm-8">
  </div>
</div>

<script type="text/javascript">
  $('.sign_btn').click(function(event){
    console.log('点击登录按钮')
  })
  $('.signin_form').on('ajax:success', function(event, xhr, data, status){
    console.log('点击登录成功', event)
    console.log('返回数据', xhr, '数据内容', data, '状态', status)
    if(event.detail[0].status == 'ok') {
      window.location.href = event.detail[0].msg.redirect_url
    } else {
      alert(event.detail[0].msg)
    }
  })
</script>
